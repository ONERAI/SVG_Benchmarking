Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 50
Rules claiming more threads will be scaled down.
Job stats:
job               count    min threads    max threads
--------------  -------  -------------  -------------
all                   1              1              1
run_GPcounts          1             10             10
run_MoranI            1             10             10
run_SOMDE             1             10             10
run_SPARK             1             10             10
run_SPARKX            1             10             10
run_Sepal             1             10             10
run_SpaGCN            1             10             10
run_SpaGFT            1             10             10
run_SpatialDE         1             10             10
run_SpatialDE2        1             10             10
run_nnSVG             1             10             10
run_scGCO             1             10             10
total                13              1             10

Select jobs to execute...

[Sat Jul 15 17:40:12 2023]
rule run_GPcounts:
    input: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    output: results/cell_type_deconvolution/GPcounts/MOBSP.csv
    jobid: 11
    benchmark: benchmarks/cell_type_deconvolution/GPcounts/MOBSP.txt
    reason: Missing output files: results/cell_type_deconvolution/GPcounts/MOBSP.csv
    wildcards: dataset=MOBSP
    threads: 10
    resources: tmpdir=/tmp


[Sat Jul 15 17:40:12 2023]
rule run_nnSVG:
    input: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    output: results/cell_type_deconvolution/nnSVG/MOBSP.csv
    jobid: 1
    benchmark: benchmarks/cell_type_deconvolution/nnSVG/MOBSP.txt
    reason: Missing output files: results/cell_type_deconvolution/nnSVG/MOBSP.csv; Updated input files: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    wildcards: dataset=MOBSP
    threads: 10
    resources: tmpdir=/tmp


[Sat Jul 15 17:40:12 2023]
rule run_MoranI:
    input: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    output: results/cell_type_deconvolution/MoranI/MOBSP.csv
    jobid: 7
    benchmark: benchmarks/cell_type_deconvolution/MoranI/MOBSP.txt
    reason: Missing output files: results/cell_type_deconvolution/MoranI/MOBSP.csv
    wildcards: dataset=MOBSP
    threads: 10
    resources: tmpdir=/tmp


[Sat Jul 15 17:40:12 2023]
rule run_SpaGFT:
    input: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    output: results/cell_type_deconvolution/SpaGFT/MOBSP.csv
    jobid: 10
    benchmark: benchmarks/cell_type_deconvolution/SpaGFT/MOBSP.txt
    reason: Missing output files: results/cell_type_deconvolution/SpaGFT/MOBSP.csv
    wildcards: dataset=MOBSP
    threads: 10
    resources: tmpdir=/tmp


[Sat Jul 15 17:40:12 2023]
rule run_SpatialDE:
    input: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    output: results/cell_type_deconvolution/SpatialDE/MOBSP.csv
    jobid: 5
    benchmark: benchmarks/cell_type_deconvolution/SpatialDE/MOBSP.txt
    reason: Missing output files: results/cell_type_deconvolution/SpatialDE/MOBSP.csv
    wildcards: dataset=MOBSP
    threads: 10
    resources: tmpdir=/tmp

Activating conda environment: zl_svg
Activating conda environment: GPcounts-GPU
Activating conda environment: nnSVG
Activating conda environment: SpatialDE
Activating conda environment: SpaGFT
/data/pinello/SHARED_SOFTWARE/anaconda_latest/envs/SpatialDE/lib/python3.8/site-packages/SpatialDE/base.py:26: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  R2 = -2. * np.dot(X, X.T) + (Xsq[:, None] + Xsq[None, :])
/data/pinello/SHARED_SOFTWARE/anaconda_latest/envs/SpatialDE/lib/python3.8/site-packages/SpatialDE/base.py:40: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  R2 = -2. * np.dot(X, X.T) + (Xsq[:, None] + Xsq[None, :])
Models:   0%|          | 0/10 [00:00<?, ?it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 37%|███▋      | 67/182 [00:00<00:00, 668.52it/s][A
 77%|███████▋  | 140/182 [00:00<00:00, 704.37it/s][A
                                                  [AModels:  10%|█         | 1/10 [00:00<00:02,  3.90it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 29%|██▊       | 52/182 [00:00<00:00, 513.25it/s][A
 57%|█████▋    | 104/182 [00:00<00:00, 423.45it/s][A
 81%|████████▏ | 148/182 [00:00<00:00, 417.09it/s][A
                                                  [AModels:  20%|██        | 2/10 [00:00<00:02,  2.79it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 16%|█▋        | 30/182 [00:00<00:00, 296.58it/s][AObatain the Laplacian matrix
Traceback (most recent call last):
  File "scripts/cell_type_deconvolution/run_SpaGFT.py", line 47, in <module>
    main()
  File "scripts/cell_type_deconvolution/run_SpaGFT.py", line 32, in main
    (ratio_low, ratio_high) = spg.gft.determine_frequency_ratio(adata, ratio_neighbors=1)
  File "/data/pinello/SHARED_SOFTWARE/anaconda_latest/envs/SpaGFT/lib/python3.8/site-packages/SpaGFT/gft.py", line 207, in determine_frequency_ratio
    high_cutoff = np.ceil(kneed_select_values(eigvals_l, increasing=False) / \
TypeError: unsupported operand type(s) for /: 'NoneType' and 'float'

 41%|████      | 74/182 [00:00<00:00, 376.73it/s][A
 62%|██████▏   | 113/182 [00:00<00:00, 375.08it/s][A
 85%|████████▌ | 155/182 [00:00<00:00, 391.39it/s][A
                                                  [AModels:  30%|███       | 3/10 [00:01<00:02,  2.40it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A[Sat Jul 15 17:40:17 2023]
Error in rule run_SpaGFT:
    jobid: 10
    input: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    output: results/cell_type_deconvolution/SpaGFT/MOBSP.csv
    conda-env: SpaGFT
    shell:
        python scripts/cell_type_deconvolution/run_SpaGFT.py -i /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad -o results/cell_type_deconvolution/SpaGFT/MOBSP.csv
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Select jobs to execute...

 16%|█▌        | 29/182 [00:00<00:00, 280.45it/s][A
[Sat Jul 15 17:40:17 2023]
rule run_Sepal:
    input: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    output: results/cell_type_deconvolution/Sepal/MOBSP.csv
    jobid: 12
    benchmark: benchmarks/cell_type_deconvolution/Sepal/MOBSP.txt
    reason: Missing output files: results/cell_type_deconvolution/Sepal/MOBSP.csv
    wildcards: dataset=MOBSP
 
  threads: 10
    resources: tmpdir=/tmp

Activating conda environment: zl_svg

 35%|███▍      | 63/182 [00:00<00:00, 308.51it/s][A
 53%|█████▎    | 96/182 [00:00<00:00, 315.92it/s][A
 71%|███████▏  | 130/182 [00:00<00:00, 322.17it/s][A
 90%|████████▉ | 163/182 [00:00<00:00, 305.84it/s][A
                                                  [AModels:  40%|████      | 4/10 [00:01<00:02,  2.07it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 25%|██▌       | 46/182 [00:00<00:00, 452.96it/s][A
 51%|█████     | 93/182 [00:00<00:00, 459.97it/s][A
 77%|███████▋  | 141/182 [00:00<00:00, 463.59it/s][A
                                                  [AModels:  50%|█████     | 5/10 [00:02<00:02,  2.22it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 35%|███▌      | 64/182 [00:00<00:00, 634.86it/s][A
 70%|███████   | 128/182 [00:00<00:00, 616.71it/s][A
                                                  [AModels:  60%|██████    | 6/10 [00:02<00:01,  2.50it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 33%|███▎      | 60/182 [00:00<00:00, 597.97it/s][A
 66%|██████▌   | 120/182 [00:00<00:00, 570.08it/s][A
 98%|█████████▊| 178/182 [00:00<00:00, 557.37it/s][A
                                                  [AModels:  70%|███████   | 7/10 [00:02<00:01,  2.67it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 33%|███▎      | 60/182 [00:00<00:00, 598.69it/s][A
 66%|██████▌   | 120/182 [00:00<00:00, 591.21it/s][A
 99%|█████████▉| 180/182 [00:00<00:00, 567.32it/s][A
                                                  [AModels:  80%|████████  | 8/10 [00:03<00:00,  2.80it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 33%|███▎      | 60/182 [00:00<00:00, 595.14it/s][A
 66%|██████▌   | 120/182 [00:00<00:00, 591.66it/s][A
 99%|█████████▉| 180/182 [00:00<00:00, 575.81it/s][A
                                                  [AModels:  90%|█████████ | 9/10 [00:03<00:00,  2.91it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 34%|███▍      | 62/182 [00:00<00:00, 615.81it/s][A
 68%|██████▊   | 124/182 [00:00<00:00, 597.79it/s][A  0%|          | 0/100 [00:00<?, ?/s]
                                                  [AModels: 100%|██████████| 10/10 [00:03<00:00,  3.00it/s]Models: 100%|██████████| 10/10 [00:03<00:00,  2.69it/s]
[Sat Jul 15 17:40:20 2023]
Finished job 5.
1 of 13 steps (8%) done
Select jobs to execute...

[Sat Jul 15 17:40:20 2023]
rule run_scGCO:
    input: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    output: results/cell_type_deconvolution/scGCO/MOBSP.csv
    jobid: 8
    benchmark: benchmarks/cell_type_deconvolution/scGCO/MOBSP.txt
    reason: Missing output files: results/cell_type_deconvolution/scGCO/MOBSP.csv; Updated input files: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    wildcards: dataset=MOBSP
    threads: 10
    resources: tmpdir=/tmp

Activating conda environment: scGCO
Traceback (most recent call last):
  File "/data/pinello/PROJECTS/2023_03_SVGBenchmarking/workflow/scripts/cell_type_deconvolution/run_Sepal.py", line 38, in <module>
    main()
  File "/data/pinello/PROJECTS/2023_03_SVGBenchmarking/workflow/scripts/cell_type_deconvolution/run_Sepal.py", line 31, in main
    sq.gr.sepal(adata, max_neighs=args.max_neighs, genes=adata.var_names, n_jobs=10)
  File "/data/pinello/SHARED_SOFTWARE/anaconda_latest/envs/zl_svg/lib/python3.9/site-packages/squidpy/gr/_sepal.py", line 119, in sepal
    raise ValueError(f"Expected `max_neighs={max_neighs}`, found node with `{max_n}` neighbors.")
ValueError: Expected `max_neighs=6`, found node with `8` neighbors.
[Sat Jul 15 17:40:24 2023]
Error in rule run_Sepal:
    jobid: 12
    input: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    output: results/cell_type_deconvolution/Sepal/MOBSP.csv
    conda-env: zl_svg
    shell:
        python scripts/cell_type_deconvolution/run_Sepal.py -i /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad -o results/cell_type_deconvolution/Sepal/MOBSP.csv
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Select jobs to execute...

[Sat Jul 15 17:40:24 2023]
rule run_SPARKX:
    input: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    output: results/cell_type_deconvolution/SPARK-X/MOBSP.csv
    jobid: 2
    benchmark: benchmarks/cell_type_deconvolution/SPARK-X/MOBSP.txt
    reason: Missing output files: results/cell_type_deconvolution/SPARK-X/MOBSP.csv; Updated input files: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    wildcards: dataset=MOBSP
    threads: 10
    resources: tmpdir=/tmp

Activating conda environment: SPARK
[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:1', device_type='GPU')]
  0%|          | 0/182 [00:00<?, ?it/s]/data/pinello/SHARED_SOFTWARE/anaconda_latest/envs/scGCO/lib/python3.9/site-packages/pysal/model/spvcm/abstracts.py:10: UserWarning: The `dill` module is required to use the sqlite backend fully.
  from .sqlite import head_to_sql, start_sql
/data/pinello/PROJECTS/2023_03_SVGBenchmarking/workflow/scripts/utils/scGCO_simple/Preprocessing.py:170: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  data = pd.DataFrame(data.values/normalizing_factor[:,np.newaxis], columns=data.columns, index=data.index)
  1%|          | 1/100 [00:06<10:14,  6.21s/] 11%|█         | 11/100 [00:06<00:41,  2.12/s] 21%|██        | 21/100 [00:07<00:17,  4.46/s] 31%|███       | 31/100 [00:07<00:09,  7.53/s]scGCO used 10 out of 256 cores
  0%|          | 0/10 [00:00<?, ?it/s] 71%|███████   | 71/100 [00:07<00:01, 25.11/s]100%|██████████| 100/100 [00:07<00:00, 12.99/s]
100%|██████████| 10/10 [00:01<00:00,  7.40it/s]100%|██████████| 10/10 [00:01<00:00,  7.39it/s]
[Sat Jul 15 17:40:29 2023]
Finished job 7.
2 of 13 steps (15%) done
Select jobs to execute...

[Sat Jul 15 17:40:29 2023]
rule run_SPARK:
    input: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    output: results/cell_type_deconvolution/SPARK/MOBSP.csv
    jobid: 3
    benchmark: benchmarks/cell_type_deconvolution/SPARK/MOBSP.txt
    reason: Missing output files: results/cell_type_deconvolution/SPARK/MOBSP.csv; Updated input files: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    wildcards: dataset=MOBSP
    threads: 10
    resources: tmpdir=/tmp

Activating conda environment: SPARK
[Sat Jul 15 17:40:30 2023]
Finished job 8.
3 of 13 steps (23%) done
Select jobs to execute...

[Sat Jul 15 17:40:30 2023]
rule run_SOMDE:
    input: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    output: results/cell_type_deconvolution/SOMDE/MOBSP.csv
    jobid: 6
    benchmark: benchmarks/cell_type_deconvolution/SOMDE/MOBSP.txt
    reason: Missing output files: results/cell_type_deconvolution/SOMDE/MOBSP.csv; Updated input files: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    wildcards: dataset=MOBSP
    threads: 10
    resources: tmpdir=/tmp

Activating conda environment: SOMDE
## ===== SPARK-X INPUT INFORMATION ==== 
## number of total samples: 278 
## number of total genes: 182 
## Running with 10 cores 
## Testing With Projection Kernel
## Testing With Gaussian Kernel 1
## Testing With Gaussian Kernel 2
## Testing With Gaussian Kernel 3
## Testing With Gaussian Kernel 4
## Testing With Gaussian Kernel 5
## Testing With Cosine Kernel 1
## Testing With Cosine Kernel 2
## Testing With Cosine Kernel 3
## Testing With Cosine Kernel 4
using 7*7 SOM nodes for 278 points
Warning: data was not float32. A 32-bit copy was made
Models:   0%|          | 0/10 [00:00<?, ?it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A## Testing With Cosine Kernel 5

 50%|█████     | 91/182 [00:00<00:00, 900.24it/s][A
100%|██████████| 182/182 [00:00<00:00, 898.33it/s][A
                                                  [AModels:  10%|█         | 1/10 [00:00<00:01,  4.90it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 35%|███▍      | 63/182 [00:00<00:00, 628.79it/s][A
 69%|██████▉   | 126/182 [00:00<00:00, 628.22it/s][A
                                                  [AModels:  20%|██        | 2/10 [00:00<00:02,  3.96it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 35%|███▍      | 63/182 [00:00<00:00, 624.57it/s][A
 69%|██████▉   | 126/182 [00:00<00:00, 624.12it/s][A
                                                  [AModels:  30%|███       | 3/10 [00:00<00:01,  3.70it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 34%|███▎      | 61/182 [00:00<00:00, 607.04it/s][A
 67%|██████▋   | 122/182 [00:00<00:00, 598.05it/s][A[Sat Jul 15 17:40:34 2023]
Finished job 2.
4 of 13 steps (31%) done
Select jobs to execute...

[Sat Jul 15 17:40:34 2023]
rule run_SpaGCN:
    input: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    output: results/cell_type_deconvolution/SpaGCN/MOBSP.csv
    jobid: 9
    benchmark: benchmarks/cell_type_deconvolution/SpaGCN/MOBSP.txt
    reason: Missing output files: results/cell_type_deconvolution/SpaGCN/MOBSP.csv; Updated input files: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    wildcards: dataset=MOBSP
    threads: 10
    resources: tmpdir=/tmp

Activating conda environment: SpaGCN

100%|██████████| 182/182 [00:00<00:00, 592.68it/s][A
                                                  [AModels:  40%|████      | 4/10 [00:01<00:01,  3.51it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 30%|███       | 55/182 [00:00<00:00, 545.61it/s][A
 60%|██████    | 110/182 [00:00<00:00, 544.63it/s][A
 92%|█████████▏| 168/182 [00:00<00:00, 555.42it/s][A
                                                  [AModels:  50%|█████     | 5/10 [00:01<00:01,  3.27it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 28%|██▊       | 51/182 [00:00<00:00, 509.48it/s][A
 56%|█████▌    | 102/182 [00:00<00:00, 506.01it/s][A
 86%|████████▋ | 157/182 [00:00<00:00, 525.75it/s][A
                                                  [AModels:  60%|██████    | 6/10 [00:01<00:01,  3.10it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 28%|██▊       | 51/182 [00:00<00:00, 506.22it/s][A
 57%|█████▋    | 104/182 [00:00<00:00, 517.91it/s][A
 87%|████████▋ | 159/182 [00:00<00:00, 530.08it/s][A
                                                  [AModels:  70%|███████   | 7/10 [00:02<00:00,  3.02it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 29%|██▊       | 52/182 [00:00<00:00, 513.28it/s][A
 59%|█████▉    | 108/182 [00:00<00:00, 538.33it/s][A
 91%|█████████ | 165/182 [00:00<00:00, 548.33it/s][A
                                                  [AModels:  80%|████████  | 8/10 [00:02<00:00,  3.00it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 31%|███       | 56/182 [00:00<00:00, 559.60it/s][A
 63%|██████▎   | 114/182 [00:00<00:00, 568.29it/s][A
 94%|█████████▍| 171/182 [00:00<00:00, 555.01it/s][A
                                                  [AModels:  90%|█████████ | 9/10 [00:02<00:00,  3.01it/s]
  0%|          | 0/182 [00:00<?, ?it/s][A
 32%|███▏      | 58/182 [00:00<00:00, 574.54it/s][A
 65%|██████▌   | 119/182 [00:00<00:00, 593.53it/s][A
 99%|█████████▉| 180/182 [00:00<00:00, 596.56it/s][A
                                                  [AModels: 100%|██████████| 10/10 [00:03<00:00,  3.08it/s]Models: 100%|██████████| 10/10 [00:03<00:00,  3.22it/s]
## ===== SPARK INPUT INFORMATION ==== 
## number of total samples:  278 
## number of total features:  182 
## number of adjusted covariates:  0 
# fitting count-based spatial model under the null hypothesis ... 
[Sat Jul 15 17:40:37 2023]
Finished job 6.
5 of 13 steps (38%) done
Select jobs to execute...

[Sat Jul 15 17:40:37 2023]
rule run_SpatialDE2:
    input: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    output: results/cell_type_deconvolution/SpatialDE2/MOBSP.csv
    jobid: 4
    benchmark: benchmarks/cell_type_deconvolution/SpatialDE2/MOBSP.txt
    reason: Missing output files: results/cell_type_deconvolution/SpatialDE2/MOBSP.csv; Updated input files: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    wildcards: dataset=MOBSP
    threads: 10
    resources: tmpdir=/tmp

Activating conda environment: SpatialDE2
## testing Gaussian kernel: 1...
## testing Periodic kernel: 1...
## testing Gaussian kernel: 2...
## testing Periodic kernel: 2...
## testing Gaussian kernel: 3...
## testing Periodic kernel: 3...
## testing Gaussian kernel: 4...
## testing Periodic kernel: 4...
## testing Gaussian kernel: 5...
## testing Periodic kernel: 5...
[Sat Jul 15 17:40:42 2023]
Finished job 3.
6 of 13 steps (46%) done
  1%|          | 1/182 [00:17<54:01, 17.91s/it]  1%|          | 2/182 [00:20<27:29,  9.16s/it]Calculateing adj matrix using xy only...
Run 1: l [0.01, 1000], p [0.0, 276.98616614210187]
Run 2: l [0.01, 500.005], p [0.0, 276.94464111328125]
Run 3: l [0.01, 250.0075], p [0.0, 276.7788391113281]
Run 4: l [0.01, 125.00874999999999], p [0.0, 276.1172180175781]
Run 5: l [0.01, 62.509375], p [0.0, 273.4992370605469]
Run 6: l [0.01, 31.2596875], p [0.0, 263.4603271484375]
Run 7: l [0.01, 15.63484375], p [0.0, 229.24671936035156]
Run 8: l [0.01, 7.822421875], p [0.0, 149.1259002685547]
Run 9: l [0.01, 3.9162109375], p [0.0, 61.99323272705078]
Run 10: l [0.01, 1.9631054687499998], p [0.0, 18.80184555053711]
Run 11: l [0.01, 0.9865527343749999], p [0.0, 4.562329292297363]
Run 12: l [0.01, 0.49827636718749996], p [0.0, 0.5828828811645508]
Run 13: l [0.25413818359374996, 0.49827636718749996], p [0.002934575080871582, 0.5828828811645508]
Run 14: l [0.37620727539062493, 0.49827636718749996], p [0.12717068195343018, 0.5828828811645508]
Run 15: l [0.4372418212890624, 0.49827636718749996], p [0.3119393587112427, 0.5828828811645508]
Run 16: l [0.4677590942382812, 0.49827636718749996], p [0.4374725818634033, 0.5828828811645508]
recommended l =  0.48301773071289056
Initializing cluster centers with louvain, resolution =  0.5
Epoch  0
Epoch  10
delta_label  0.0 < tol  0.005
Reach tolerance threshold. Stopping training.
Total epoch: 19
target: 0
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [0.8920210835337639, 3.2016489505767822], num_nbr [1.2777777777777777, 25.34259259259259]
Calculateing adj matrix using xy only...
Run 2: radius [2.046835017055273, 3.2016489505767822], num_nbr [9.87037037037037, 25.34259259259259]
Calculateing adj matrix using xy only...
Run 3: radius [2.046835017055273, 2.6242419838160274], num_nbr [9.87037037037037, 16.185185185185187]
Calculateing adj matrix using xy only...
Run 4: radius [2.046835017055273, 2.33553850043565], num_nbr [9.87037037037037, 15.49074074074074]
Calculateing adj matrix using xy only...
recommended radius =  2.191186758745461 num_nbr=12.435185185185185
radius= 2.191186758745461 average number of neighbors for each spot is 12.435185185185185
 Cluster 0 has neighbors:
Dmain  2 :  391
Dmain  1 :  40
target: 1
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [0.8920210835337639, 3.2016489505767822], num_nbr [1.394736842105263, 33.473684210526315]
Calculateing adj matrix using xy only...
recommended radius =  2.046835017055273 num_nbr=12.18421052631579
radius= 2.046835017055273 average number of neighbors for each spot is 12.18421052631579
 Cluster 1 has neighbors:
Dmain  2 :  227
Dmain  0 :  19
target: 2
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [0.8920210835337639, 3.2016489505767822], num_nbr [1.1914893617021276, 28.69148936170213]
Calculateing adj matrix using xy only...
recommended radius =  2.046835017055273 num_nbr=11.042553191489361
radius= 2.046835017055273 average number of neighbors for each spot is 11.042553191489361
 Cluster 2 has neighbors:
Dmain  0 :  283
Dmain  1 :  227
[Sat Jul 15 17:40:48 2023]
Finished job 9.
7 of 13 steps (54%) done
  2%|▏         | 3/182 [00:24<19:01,  6.38s/it][Sat Jul 15 17:40:49 2023]
Finished job 1.
8 of 13 steps (62%) done
  2%|▏         | 4/182 [00:26<14:04,  4.75s/it][Sat Jul 15 17:40:52 2023]
Finished job 4.
9 of 13 steps (69%) done
  3%|▎         | 5/182 [00:28<11:15,  3.82s/it]  3%|▎         | 6/182 [00:30<09:34,  3.27s/it]  4%|▍         | 7/182 [00:32<08:26,  2.89s/it]  4%|▍         | 8/182 [00:35<08:35,  2.96s/it]  5%|▍         | 9/182 [00:46<15:54,  5.52s/it]  5%|▌         | 10/182 [00:58<21:22,  7.45s/it]  6%|▌         | 11/182 [01:01<16:44,  5.87s/it]  7%|▋         | 12/182 [01:04<14:09,  5.00s/it]  7%|▋         | 13/182 [01:06<11:44,  4.17s/it]  8%|▊         | 14/182 [01:08<10:01,  3.58s/it]  8%|▊         | 15/182 [01:20<16:47,  6.03s/it]  9%|▉         | 16/182 [01:22<13:33,  4.90s/it]  9%|▉         | 17/182 [01:34<19:18,  7.02s/it] 10%|▉         | 18/182 [01:36<15:16,  5.59s/it] 10%|█         | 19/182 [01:47<19:43,  7.26s/it] 11%|█         | 20/182 [01:51<16:15,  6.02s/it] 12%|█▏        | 21/182 [01:53<13:09,  4.90s/it] 12%|█▏        | 22/182 [01:55<10:50,  4.06s/it] 13%|█▎        | 23/182 [02:07<16:56,  6.39s/it] 13%|█▎        | 24/182 [02:09<13:35,  5.16s/it] 14%|█▎        | 25/182 [02:11<11:18,  4.32s/it] 14%|█▍        | 26/182 [02:14<09:37,  3.70s/it] 15%|█▍        | 27/182 [02:26<15:58,  6.18s/it] 15%|█▌        | 28/182 [02:38<20:19,  7.92s/it] 16%|█▌        | 29/182 [02:40<15:56,  6.25s/it] 16%|█▋        | 30/182 [02:42<12:48,  5.06s/it] 17%|█▋        | 31/182 [02:45<11:04,  4.40s/it] 18%|█▊        | 32/182 [02:57<16:46,  6.71s/it] 18%|█▊        | 33/182 [03:00<13:28,  5.42s/it] 19%|█▊        | 34/182 [03:12<18:15,  7.40s/it] 19%|█▉        | 35/182 [03:23<20:54,  8.54s/it] 20%|█▉        | 36/182 [03:25<16:09,  6.64s/it] 20%|██        | 37/182 [03:28<13:27,  5.57s/it] 21%|██        | 38/182 [03:39<17:24,  7.26s/it] 21%|██▏       | 39/182 [03:44<15:22,  6.45s/it] 22%|██▏       | 40/182 [03:47<13:06,  5.54s/it] 23%|██▎       | 41/182 [03:50<10:43,  4.56s/it] 23%|██▎       | 42/182 [03:52<09:09,  3.93s/it] 24%|██▎       | 43/182 [03:55<08:27,  3.65s/it] 24%|██▍       | 44/182 [03:58<08:11,  3.56s/it] 25%|██▍       | 45/182 [04:02<08:20,  3.65s/it] 25%|██▌       | 46/182 [04:05<07:53,  3.48s/it] 26%|██▌       | 47/182 [04:08<07:12,  3.20s/it] 26%|██▋       | 48/182 [04:13<08:20,  3.73s/it] 27%|██▋       | 49/182 [04:17<08:18,  3.75s/it] 27%|██▋       | 50/182 [04:19<07:39,  3.48s/it] 28%|██▊       | 51/182 [04:24<08:16,  3.79s/it] 29%|██▊       | 52/182 [04:27<07:27,  3.44s/it] 29%|██▉       | 53/182 [04:31<08:16,  3.85s/it] 30%|██▉       | 54/182 [04:34<07:28,  3.51s/it] 30%|███       | 55/182 [04:38<07:28,  3.53s/it] 31%|███       | 56/182 [04:41<07:31,  3.58s/it] 31%|███▏      | 57/182 [04:46<07:57,  3.82s/it] 32%|███▏      | 58/182 [04:49<07:29,  3.63s/it] 32%|███▏      | 59/182 [05:01<12:45,  6.22s/it] 33%|███▎      | 60/182 [05:04<10:29,  5.16s/it] 34%|███▎      | 61/182 [05:08<09:52,  4.90s/it] 34%|███▍      | 62/182 [05:14<10:24,  5.21s/it] 35%|███▍      | 63/182 [05:17<09:05,  4.59s/it] 35%|███▌      | 64/182 [05:22<08:48,  4.48s/it] 36%|███▌      | 65/182 [05:24<07:34,  3.88s/it] 36%|███▋      | 66/182 [05:34<11:08,  5.76s/it] 37%|███▋      | 67/182 [05:46<14:41,  7.66s/it] 37%|███▋      | 68/182 [05:49<11:37,  6.11s/it] 38%|███▊      | 69/182 [05:52<09:41,  5.14s/it] 38%|███▊      | 70/182 [05:59<11:04,  5.93s/it] 39%|███▉      | 71/182 [06:06<11:13,  6.06s/it] 40%|███▉      | 72/182 [06:09<09:23,  5.13s/it] 40%|████      | 73/182 [06:21<13:16,  7.31s/it] 41%|████      | 74/182 [06:25<11:12,  6.23s/it] 41%|████      | 75/182 [06:28<09:31,  5.34s/it] 42%|████▏     | 76/182 [06:33<09:24,  5.33s/it] 42%|████▏     | 77/182 [06:36<07:53,  4.51s/it] 43%|████▎     | 78/182 [06:48<11:55,  6.88s/it] 43%|████▎     | 79/182 [06:51<09:44,  5.68s/it] 44%|████▍     | 80/182 [07:04<13:07,  7.72s/it] 45%|████▍     | 81/182 [07:08<11:08,  6.62s/it] 45%|████▌     | 82/182 [07:18<12:55,  7.75s/it] 46%|████▌     | 83/182 [07:31<15:15,  9.25s/it] 46%|████▌     | 84/182 [07:34<11:52,  7.27s/it] 47%|████▋     | 85/182 [07:36<09:31,  5.89s/it] 47%|████▋     | 86/182 [07:39<07:56,  4.96s/it] 48%|████▊     | 87/182 [07:52<11:26,  7.22s/it] 48%|████▊     | 88/182 [08:04<13:40,  8.73s/it] 49%|████▉     | 89/182 [08:16<15:11,  9.80s/it] 49%|████▉     | 90/182 [08:19<11:47,  7.69s/it] 50%|█████     | 91/182 [08:22<09:26,  6.22s/it] 51%|█████     | 92/182 [08:25<08:07,  5.42s/it] 51%|█████     | 93/182 [08:27<06:35,  4.44s/it] 52%|█████▏    | 94/182 [08:30<05:45,  3.93s/it] 52%|█████▏    | 95/182 [08:39<07:56,  5.47s/it] 53%|█████▎    | 96/182 [08:42<06:40,  4.65s/it] 53%|█████▎    | 97/182 [08:54<09:53,  6.98s/it] 54%|█████▍    | 98/182 [08:57<07:53,  5.63s/it] 54%|█████▍    | 99/182 [09:00<06:50,  4.94s/it] 55%|█████▍    | 100/182 [09:03<05:57,  4.35s/it] 55%|█████▌    | 101/182 [09:14<08:41,  6.44s/it] 56%|█████▌    | 102/182 [09:18<07:23,  5.55s/it] 57%|█████▋    | 103/182 [09:22<06:54,  5.25s/it] 57%|█████▋    | 104/182 [09:34<09:10,  7.06s/it] 58%|█████▊    | 105/182 [09:42<09:33,  7.44s/it] 58%|█████▊    | 106/182 [09:48<08:55,  7.04s/it] 59%|█████▉    | 107/182 [09:59<10:24,  8.32s/it] 59%|█████▉    | 108/182 [10:04<08:44,  7.08s/it] 60%|█████▉    | 109/182 [10:08<07:46,  6.39s/it] 60%|██████    | 110/182 [10:12<06:37,  5.52s/it] 61%|██████    | 111/182 [10:23<08:34,  7.25s/it] 62%|██████▏   | 112/182 [10:26<06:50,  5.86s/it] 62%|██████▏   | 113/182 [10:38<08:56,  7.78s/it] 63%|██████▎   | 114/182 [10:41<07:09,  6.32s/it] 63%|██████▎   | 115/182 [10:53<09:01,  8.09s/it] 64%|██████▎   | 116/182 [11:06<10:32,  9.58s/it] 64%|██████▍   | 117/182 [11:09<08:06,  7.49s/it] 65%|██████▍   | 118/182 [11:21<09:31,  8.92s/it] 65%|██████▌   | 119/182 [11:26<07:58,  7.59s/it] 66%|██████▌   | 120/182 [11:30<06:53,  6.68s/it] 66%|██████▋   | 121/182 [11:33<05:37,  5.53s/it] 67%|██████▋   | 122/182 [11:36<04:47,  4.79s/it] 68%|██████▊   | 123/182 [11:40<04:22,  4.44s/it] 68%|██████▊   | 124/182 [11:51<06:17,  6.50s/it] 69%|██████▊   | 125/182 [12:03<07:47,  8.21s/it] 69%|██████▉   | 126/182 [12:08<06:40,  7.16s/it] 70%|██████▉   | 127/182 [12:11<05:27,  5.95s/it] 70%|███████   | 128/182 [12:16<05:02,  5.61s/it] 71%|███████   | 129/182 [12:28<06:43,  7.62s/it] 71%|███████▏  | 130/182 [12:32<05:42,  6.59s/it] 72%|███████▏  | 131/182 [12:36<04:43,  5.56s/it] 73%|███████▎  | 132/182 [12:48<06:19,  7.59s/it] 73%|███████▎  | 133/182 [12:54<05:44,  7.03s/it] 74%|███████▎  | 134/182 [13:06<06:58,  8.71s/it] 74%|███████▍  | 135/182 [13:19<07:49,  9.98s/it] 75%|███████▍  | 136/182 [13:31<08:03, 10.50s/it] 75%|███████▌  | 137/182 [13:36<06:32,  8.73s/it] 76%|███████▌  | 138/182 [13:38<05:00,  6.84s/it] 76%|███████▋  | 139/182 [13:50<06:06,  8.53s/it] 77%|███████▋  | 140/182 [14:03<06:45,  9.66s/it] 77%|███████▋  | 141/182 [14:06<05:15,  7.71s/it] 78%|███████▊  | 142/182 [14:12<04:52,  7.31s/it] 79%|███████▊  | 143/182 [14:16<04:08,  6.37s/it] 79%|███████▉  | 144/182 [14:19<03:19,  5.25s/it] 80%|███████▉  | 145/182 [14:23<03:01,  4.91s/it] 80%|████████  | 146/182 [14:36<04:17,  7.16s/it] 81%|████████  | 147/182 [14:39<03:27,  5.93s/it] 81%|████████▏ | 148/182 [14:51<04:28,  7.89s/it] 82%|████████▏ | 149/182 [15:02<04:54,  8.92s/it] 82%|████████▏ | 150/182 [15:05<03:47,  7.12s/it] 83%|████████▎ | 151/182 [15:18<04:30,  8.74s/it] 84%|████████▎ | 152/182 [15:30<04:54,  9.82s/it] 84%|████████▍ | 153/182 [15:36<04:08,  8.55s/it] 85%|████████▍ | 154/182 [15:39<03:16,  7.02s/it] 85%|████████▌ | 155/182 [15:45<02:56,  6.53s/it] 86%|████████▌ | 156/182 [15:51<02:46,  6.42s/it] 86%|████████▋ | 157/182 [16:03<03:26,  8.24s/it] 87%|████████▋ | 158/182 [16:06<02:37,  6.58s/it] 87%|████████▋ | 159/182 [16:10<02:16,  5.92s/it] 88%|████████▊ | 160/182 [16:14<01:56,  5.31s/it] 88%|████████▊ | 161/182 [16:17<01:34,  4.50s/it] 89%|████████▉ | 162/182 [16:20<01:19,  3.97s/it] 90%|████████▉ | 163/182 [16:32<02:03,  6.52s/it] 90%|█████████ | 164/182 [16:44<02:28,  8.27s/it] 91%|█████████ | 165/182 [16:47<01:50,  6.48s/it] 91%|█████████ | 166/182 [16:50<01:25,  5.37s/it] 92%|█████████▏| 167/182 [16:53<01:09,  4.66s/it] 92%|█████████▏| 168/182 [17:00<01:15,  5.38s/it] 93%|█████████▎| 169/182 [17:02<00:58,  4.48s/it] 93%|█████████▎| 170/182 [17:04<00:46,  3.87s/it] 94%|█████████▍| 171/182 [17:17<01:11,  6.49s/it] 95%|█████████▍| 172/182 [17:28<01:19,  7.93s/it] 95%|█████████▌| 173/182 [17:33<01:01,  6.86s/it] 96%|█████████▌| 174/182 [17:36<00:47,  5.94s/it] 96%|█████████▌| 175/182 [17:39<00:34,  4.90s/it] 97%|█████████▋| 176/182 [17:51<00:41,  6.94s/it] 97%|█████████▋| 177/182 [17:55<00:30,  6.16s/it] 98%|█████████▊| 178/182 [18:06<00:30,  7.73s/it] 98%|█████████▊| 179/182 [18:09<00:18,  6.09s/it] 99%|█████████▉| 180/182 [18:21<00:15,  7.98s/it] 99%|█████████▉| 181/182 [18:26<00:07,  7.07s/it]100%|██████████| 182/182 [18:29<00:00,  5.96s/it]100%|██████████| 182/182 [18:29<00:00,  6.10s/it]
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Can not Optimaize a Gaussian process, Optimization fail.
Traceback (most recent call last):
  File "/data/pinello/PROJECTS/2023_03_SVGBenchmarking/workflow/scripts/cell_type_deconvolution/run_GPcounts.py", line 78, in <module>
    main()
  File "/data/pinello/PROJECTS/2023_03_SVGBenchmarking/workflow/scripts/cell_type_deconvolution/run_GPcounts.py", line 72, in main
    df['spatially_variable'] = adata.var.spatially_variable.astype(np.int16).values
  File "/data/pinello/SHARED_SOFTWARE/anaconda_latest/envs/GPcounts-GPU/lib/python3.9/site-packages/pandas/core/generic.py", line 5902, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'spatially_variable'
[Sat Jul 15 17:58:57 2023]
Error in rule run_GPcounts:
    jobid: 11
    input: /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad
    output: results/cell_type_deconvolution/GPcounts/MOBSP.csv
    conda-env: GPcounts-GPU
    shell:
        python scripts/cell_type_deconvolution/run_GPcounts.py -i /data/pinello/PROJECTS/2023_03_SVGBenchmarking/CellTypeDeconvolution/data/MOBSP.h5ad -o results/cell_type_deconvolution/GPcounts/MOBSP.csv
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2023-07-15T174009.726891.snakemake.log
